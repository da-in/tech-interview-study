# 인터럽트 (Interrupt)

## 인터럽트란?
CPU가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치나 예외 상황이 발생하여 처리가 필요한 경우에 CPU에게 알려 처리할 수 있도록 하는 것이다. </br>
즉, CPU가 특정 기능을 수행하는 도중에 급하게 다른 일을 처리하고자 할 때 사용할 수 있는 기능 </br>
인터럽트는 크게 **하드웨어 인터럽트** 와 **소프트웨어 인터럽트**로 나뉜다. </br>


### 하드웨어 인터럽트
- 하드웨어가 발생시키는 인터럽트로 CPU가 아닌 다른 하드웨어 장치가 CPU에게 어떤 사실을 알려주거나, CPU 서비스를 요청해야 할 경우 발생시킨다.</br>
  - **입출력 인터럽트 (I/O Interrupt)** : 입출력의 종료 등의 이유로 CPU의 수행 요청
  - **전원 이상 인터럽트** : 정전이나 전원이 이상이 있는 경우
  - **기계 고정 인터럽트** : CPU등의 기능적인 동작 오류가 발생한 경우



### 소프트웨어 인터럽트
- 소프트웨어가 발생시키는 인터럽트이고, **예외(Exception) 상황**이나, **System Call** 모두 소프트웨어 인터럽트이다. </br>
  - **0으로 나누는 경우**
  - **오버플로우 / 언더플로우**
  - **프로그램 상의 오류**



## 인터럽트 벡터
- 여러가지 인터럽트에 대해 해당 인터럽트가 발생시 처리해야 할 루틴(ISR)의 주소를 보관하고 있는 공간
- 보통의 CPU들은 인터럽트 벡터 테이블을 가지고 있다. </br>



## 인터럽트 서비스 루틴 (ISR)
- 같은말로 **인터럽트 핸들러**이다.
- 인터럽트가 접수되면 각 인터럽트에 대응하여 특정 기능을 수행하는 **기계어 코드 루틴 실행** (커널이 실행) </br>


## 인터럽트 과정
프로세스 A가 실행 중 디스크에서 어떤 데이터를 읽어오라는 명령을 받았다고 가정하자.</br>

- 프로세스 A는 `System Call`을 통해 인터럽트를 발생시킨다.
- CPU는 현재 진행중인 코드를 완료하고, 상태를 해당 프로세스의 PCB에 저장한다.
- PC에 다음 실행할 명령의 주소 저장
- 인터럽드 벡터를 읽고 **ISR 주소값**을 얻어 ISR으로 점프하여 코드 루틴 실행
- 다 처리하면 저장해놨던 프로세스 상태를 복구
- ISR의 끝에 **IRET 명령어**에 의해 인터럽트가 해제
- IRET 명령어가 실행되면, 저장했던 PC 값을 복원해서 이전 실행위치로 복구</br>

> IRET 명렁어란? - 이전 task로 돌아가는 어셈블리 명령어 </br>




----

## Referance
- https://doh-an.tistory.com/31
- https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8
- https://velog.io/@hyun0310woo/7.-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C-%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8%EC%97%90-%EB%8C%80%ED%95%B4%EC%84%9C
