# 페이징 & 세그먼테이션(PDF)

## 개념
다중 프로그래밍 시스템에 여러 프로세스를 수용하기 위해 주 기억 장치를 동적 분할하는 메모리 관리 작업이 필요하다. </br>

## Contiguous Allocation (연속 메모리 할당)
- 메모리를 할당할 때 연속적으로 할당해주는 방식이다. </br>
- 프로세스를 메모리에 담기 위해 메모리는 미리 공간을 분할해두는데, 두가지 방식이 존재한다.
  - 고정 분할 방식 : 메모리가 고정된 파티션(크기)으로 분할되고, 하나당 하나의 프로세스가 적재된다. -> 내부 단편화가 발생
  - 동적 분할 방식 : 프로세스의 크기를 고려해서 파티션들이 동적 할당되며 크기나 개수가 동적으로 변한다 -> 외부 단편화 발생 </br>



## 단편화(Fragmentation)
-기억 장치의 나머지 빈 공간이 여러 조각으로 나뉘는 현상이다. </br>
-프로세스들이 메모리에 적재되고 제거되는 일이 반복되면, 프로세스들이 차지하는 메모리 틈 사이사이에 빈 공간들이 늘어나는 현상 </br>
- 내부 단편화와 외부 단편화로 나뉜다.
- **내부 단편화 (Internal Fragmentation)**
  - 프로세스가 사용하는 메모리 공간에 남는 부분
  - 프로세스가 요청한 양보다 더 많은 메모리를 할당할 때 발생
  <img src = "https://user-images.githubusercontent.com/102718303/210676423-bb09a5c8-8d20-4820-a210-69e821adf060.png">

- **외부 단편화 (External Fragmentation)**
  - 메모리  공간 중 사용하지 못하는 부분
  - 메모리의 할당 & 해제의 반복으로 작은 크기의 빈 공간이 중간중간 존재할 수 있다.
  - 프로세스가 사용하는 공간을 한쪽으로 몰아서 공간을 확보하는 **압축(Compaction)**을 사용하면 해결 가능 -> 효율성이 떨어진다.
  <img src = "https://user-images.githubusercontent.com/102718303/210676654-bf1aa192-243e-4142-899a-4c4856fdb46b.png">

</br>


## 불연속 메모리 관리
- 프로그램의 일부가 서로 다른 주소 공간에 할당될 수 있는 기법이다. </br>
- 위의 단편화를 해결하기 위해 고안된 방법이고, 크게 2가지 방법이 있다. </br>
- **페이징** : 내부 단편화 해결
- **세그멘테이션** : 외부 단편화 해결

</br>


## 페이징(Paging)
프로세스를 일정한 크기의 페이지로 분할해서 메모리에 적재하는 방식이다.

> 페이지 : 일정 사이즈의 가상 메모리 내 프로세스 조각 </br>
> 프레임 : 페이지와 동일한 크기의 주 기억 장치의 메모리 조각



### 페이징 테이블 (Paging Table)
모든 프로세스는 하나의 페이징 테이블을 가지고 있다. </br>
페이징 테이블에는 각 페이지 번호와 그 페이지가 위치하는 프레임의 시작주소가 있다. </br>
즉, 페이징 테이블을 통해 가상 메모리 상의 페이지들이 실제 메인 메모리의 어디 프레임에 적재되어 있는지 알 수 있다. </br>

<img width="600" src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FlUpSH%2FbtrfV9pcZrh%2FWtBruLdUe5uDYa2zpET6uK%2Fimg.png">



### 장점
- 연속되어 저장되지 않기 때문에 외부 단편화가 생기지 않는다.
- 할당과 해제가 빠르다
- swap out이 간단하다.



### 단점
- 페이지 단위에 딱맞게 꽉채워 쓰는게 아니므로 내부 단편화 문제가 발생할 수 있다. </br>
  - 페이지 단위가 작으면 해결할 수 있지만 매핑이 복잡해진다.
- page table을 위한 메모리가 추가로 소모된다.
- page table이 메모리에 있기 때문에 접근하는 연산은 2번의 메모리 접근이 필요하게 되어 속도가 느리다.
  - 속도 향상을 위해 `TLB`를 사용한다.
  
</br>


## 세그멘테이션(Segmentation)
- 프로세스를 페이지 단위로 분할하지 않고, 세그먼트로 분할해서 메모리에 적재한다.
- 일반적으로 code, data, stack 부분이 하나의 세그먼트로 정의된다.

> 세그먼트 : 가상 메모리를 서로 크기가 다른 논리적 단위로 분할


### 세그먼트 테이블
위의 페이징 테이블과 똑같이 작동한다. </br>
다른 점은 세그먼트는 분할한 크기가 각각 다르기 때문에 세그먼트의 길이 정보가 추가된다.


### 장점
- 프로세스가 필요한 만큼 할당해주기 때문에 내부 단편화가 발생하지 않는다. 


### 단점
- 외부 단편화 문제가 발생 할 수 있다.

----

## Reference
- https://steady-coding.tistory.com/524
- https://kyoun.tistory.com/31




